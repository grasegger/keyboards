points:
  zones:
    matrix:
      columns:
        pinky:
          rows:
            bottom:
              column_net: P21
            home:
              column_net: P18
 
        ring:
          spread: u
          rows:
            bottom:
              column_net: P20
            home:
              column_net: P15
      
        middle:
          spread: u
          rows:
            bottom:
              column_net: P9
            home:
              column_net: P19
    
        index:
          spread: u
          stagger: -u
          rows:
            thumb:
              column_net: P4
            home:
              column_net: P6
              bind: [3u +7, u] 
            bottom:
              column_net: P5
                

        inner:
          spread: u
          rows:
            thumb:
              column_net: P3
              
      key:
        footprints:
          mx:
            type: mx
            nets:
              from: =column_net
              to: GND
            params:
                hotswap: true
                keycaps: true
                reverse: true


outlines:
  exports:
    raw:
      - type: keys
        side: left
        size: [14 , 14]
        corner: 0
        bound: true
    panel:
      - type: outline
        name: raw
        fillet: 0
    pcbkeys:
      - type: keys
        side: left
        size: [u,u]
        corner: 0
      
    pcb:
      - type: outline
        fillet: 2
        name: pcbkeys

    top_plate:
      - type: outline
        name: pcb
        fillet: 1
      - type: keys
        side: left
        operation: subtract
        bound: false
        size:  [14, 14]

        # reset button cutout
      - type: rectangle
        operation: subtract
        size: 25 
        anchor:
          ref: matrix_middle_bottom
          rotate: 45
          shift: [-2.5u, 2u - 3]

# screw holes top
      - type: circle
        radius: 1.1
        operation: subtract
        anchor:
          ref: matrix_middle_bottom
          shift: [ -2u, 2u]
      - type: circle
        radius: 1.1
        operation: subtract
        anchor:
          ref: matrix_middle_bottom
          shift: [-2u, -2u]
      - type: circle
        radius: 1.1
        operation: subtract
        anchor:
          ref: matrix_middle_bottom
          shift: [u - u/2 + 1.6, 2u]

    final:
      - type: outline
        name: pcb
        fillet: 1

        
# on off left
      - type: rectangle
        operation: subtract
        size: [3, 10]
        anchor:
          ref: matrix_middle_home
          shift: [83.5 - 2u, -5]
          
# screw holes left
      - type: circle
        radius: 1.6
        operation: subtract
        anchor:
          ref: matrix_middle_bottom
          shift: [ -2u, 2u]
      - type: circle
        radius: 1.6
        operation: subtract
        anchor:
          ref: matrix_middle_bottom
          shift: [-2u, -2u]
      - type: circle
        radius: 1.6
        operation: subtract
        anchor:
          ref: matrix_middle_bottom
          shift: [u - u/2 + 1.6, 2u]
      - type: circle
        radius: 1.1
        operation: subtract
        anchor:
          ref: matrix_middle_bottom
          shift: [-2u, u]
      - type: circle
        radius: 1.1
        operation: subtract
        anchor:
          ref: matrix_middle_bottom
          shift: [-u, -2u]
      - type: circle
        radius: 1.1
        operation: subtract
        anchor:
          ref: matrix_middle_bottom
          shift: [u + u/2, -2u]
      - type: circle
        radius: 1.1
        operation: subtract
        anchor:
          ref: matrix_middle_bottom
          shift: [u + u/2, u]          

pcbs:
  lasagna_shield:
    outlines:
      top_plate:
        outline: top_plate

    footprints:
      silk:
        type: silk
        params:
          path: ../output/edc.kicad_mod
     
  lasagna:
    outlines:
      - outline: final
    footprints:
      on_off:
        type: slider
        anchor:
          shift: [81.5 - 2u, 0]
          ref: matrix_middle_home
          rotate: -90
        params:
          side: B
        nets:
          from: BATPSWITCH
          to: BAT+
      battery_connector:
        type: jstph
        anchor:
          rotate: 90
          shift: [0, -14]
          ref: matrix_pinky_bottom
        params:
          side: F
        nets:
          pos: BATPSWITCH
          neg: GND
      reset:
        type: reset
        anchor:
          shift: [ -6 , 63]
          rotate: 225
          ref: matrix_pinky_bottom
        nets:
          from: RST
          to: GND
      puck:
        type: puck
        anchor:
          shift: [u/2, -u/6] 
          rotate: -0
          ref: matrix_middle_bottom
      mcu:
        type: promicro
        anchor:
          shift: [66, 57]
          ref: matrix_pinky_bottom
          rotate: 180
        params:
          orientation: down
